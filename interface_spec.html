<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. Interface Specification &mdash; 7819 DMS 1.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="7819 DMS 1.0.1 documentation" href="index_BioTek.html" />
    <link rel="prev" title="2. Interface Control Document" href="interface_control_doc.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="interface-specification">
<span id="interface-spec"></span><h1>3. Interface Specification<a class="headerlink" href="#interface-specification" title="Permalink to this headline">¶</a></h1>
<div class="section" id="copyright">
<h2>3.1. Copyright<a class="headerlink" href="#copyright" title="Permalink to this headline">¶</a></h2>
<p>Copyright Creare LLC 2016.  This software specification is proprietary and should be considered confidential.  Reproduction or distribution prohibited without written permission from Creare.</p>
</div>
<div class="section" id="overview">
<h2>3.2. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This document describes the software interface that interacts with the DMS firmware. There are two primary components of this interface:</p>
<ol class="arabic simple">
<li>A <a class="reference internal" href="#configuration-gui"><span>GUI</span></a> which allows comprehensive interaction with the DMS for purposes of alignment, calibration, and debugging. This GUI will only be accessed by trained technicians, not by the end-user.</li>
<li>A simple, low level <a class="reference internal" href="#biotek-interface"><span>interface</span></a> which the BioTek host application uses to send simple commands and recieve fault detection data from the DMS during normal operation.</li>
</ol>
</div>
<div class="section" id="host">
<h2>3.3. Host<a class="headerlink" href="#host" title="Permalink to this headline">¶</a></h2>
<p>For product roll-out, the DMS will be controlled by a PC (Windows 7 or later) over a USB interface. In the future, different devices may interact with the DMS and act as its host, such as the dispenser itself, which runs Windows CE. Consequently, the USB interface and commands should be kept simple and generic.</p>
</div>
<div class="section" id="configuration-gui">
<span id="id1"></span><h2>3.4. Configuration GUI<a class="headerlink" href="#configuration-gui" title="Permalink to this headline">¶</a></h2>
<p>A GUI is required to execute the various functions defined in the <a class="reference internal" href="firmware_spec.html#firmware-spec"><span>Firmware Specification</span></a> and display the results. This GUI will be used for testing here at Creare, but will also become deployable code.  Ultimately, this GUI will be activated from within the host’s user interface.  It will be used only by technicians trained to align, calibrate, and debug the device. It will not be available to end-users.</p>
<p>Parameters stored in the GUI are tabulated in <a class="reference internal" href="#gui-parameters"><span>Table 3.1</span></a>:</p>
<table border="1" class="docutils" id="gui-parameters">
<caption><span class="caption-number">Table 3.1 </span><span class="caption-text">GUI Parameters</span><a class="headerlink" href="#gui-parameters" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">dms_id</span></code></td>
<td>The ID of the currently connected DMS.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">file_string</span></code></td>
<td>A string that is inserted into all saved filenames for identification purposes. Default is an empty string.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">save_path</span></code></td>
<td>Path where all files are saved. Default is a <code class="docutils literal"><span class="pre">data</span></code> folder in the DMS GUI software base path.</td>
</tr>
</tbody>
</table>
<p>The GUI should have buttons to:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>Connect to DMS.</strong> List all DMS systems connected to the host and allow the user to select one to connect to. Assign the result to <code class="docutils literal"><span class="pre">dms_id</span></code>. Display the ID of the connected DMS at all times. (See <a class="reference internal" href="firmware_spec.html#identification"><span>Identification</span></a>.)</li>
<li><strong>Edit dispense parameters.</strong> Display an editable list of the <a class="reference internal" href="firmware_spec.html#configuration-parameters"><span>Table 1.1</span></a>  <a class="reference internal" href="firmware_spec.html#configuration-parameters"><span>Configuration Parameters</span></a> in a pop-up window. Provide confirmation and cancel buttons.</li>
<li><strong>Edit file strings.</strong> Allow user to edit <code class="docutils literal"><span class="pre">file_string</span></code> and <code class="docutils literal"><span class="pre">save_path</span></code>. It would be nice if there was a ‘browse’ button for the <code class="docutils literal"><span class="pre">file_path</span></code>.</li>
<li><strong>View static parameters.</strong> Display the <a class="reference internal" href="firmware_spec.html#static-parameters"><span>Table 1.2</span></a> <a class="reference internal" href="firmware_spec.html#static-parameters"><span>Static Parameters</span></a> in a text format in a pop-up window. Also display the firmware version in this output.</li>
<li><strong>View background.</strong>  Display <code class="docutils literal"><span class="pre">cal_background</span></code> as a bar plot. For display, the data should be normalized at the ADC full scale and the y-limit fixed at 1. If <code class="docutils literal"><span class="pre">cal_bin_edges</span></code> is defined, indicate these values on the bar plot by overlaying bold vertical lines at the appropriate pixel locations. (See <a class="reference internal" href="firmware_spec.html#calibration"><span>Calibration</span></a>.)</li>
<li><strong>View calibration parameters.</strong> Display the <a class="reference internal" href="firmware_spec.html#calibration-parameters"><span>Table 1.3</span></a> <a class="reference internal" href="firmware_spec.html#calibration-parameters"><span>Calibration Parameters</span></a> (except <code class="docutils literal"><span class="pre">cal_background</span></code> and <code class="docutils literal"><span class="pre">cal_image</span></code>) in a text format in a pop-up window. Also display <code class="docutils literal"><span class="pre">cal_image</span></code> as a bar plot. For display, the data should be normalized at the ADC full scale and the y-limit fixed at 1. If <code class="docutils literal"><span class="pre">cal_bin_edges</span></code> is defined, indicate these values on the bar plot by overlaying bold vertical lines at the appropriate pixel locations.</li>
<li><strong>Initiate alignment mode.</strong> Show a live bar-graph of the raw detector signal using the <code class="docutils literal"><span class="pre">align()</span></code> function. Overlay a line plot of <code class="docutils literal"><span class="pre">cal_background</span></code> on top of this dynamic bar plot. For display, the data should be normalized at the ADC full scale and the y-limit fixed at 1. Provide a button or keystroke to exit this mode. (See <a class="reference internal" href="firmware_spec.html#calibration"><span>Calibration</span></a>.)</li>
<li><strong>Update dark level.</strong> Prompt the user to cover the sensor. After the user confirms, run <code class="docutils literal"><span class="pre">get_dark_level()</span></code>. Report both the original and the resulting <code class="docutils literal"><span class="pre">dark_level</span></code> in an informational pop-up window. (See <a class="reference internal" href="firmware_spec.html#calibration"><span>Calibration</span></a>.)</li>
<li><strong>Collect new background.</strong> Prompt the user to confirm that they want to overwrite the current background. Prompt the user to confirm that the laser is aligned, no dispense cartridge is in place, and the optical path is clear.  Then run the <code class="docutils literal"><span class="pre">set_background()</span></code> function. Display the resulting background using the function defined in item 6 above. (See <a class="reference internal" href="firmware_spec.html#calibration"><span>Calibration</span></a>.)</li>
<li><strong>Calibrate.</strong> Prompt the user to install the calibration cassette. Then run the <code class="docutils literal"><span class="pre">calibrate()</span></code> function.  Display the resulting calibration using the function defined above. (See <a class="reference internal" href="firmware_spec.html#calibration"><span>Calibration</span></a>.)</li>
<li><strong>Record data.</strong> Prompt user for a record <code class="docutils literal"><span class="pre">duration</span></code> in seconds (default 10). When user clicks go, run the <code class="docutils literal"><span class="pre">stream_data(duration)</span></code> function. Write this data to an ASCII file as a <code class="docutils literal"><span class="pre">duration</span> <span class="pre">X</span> <span class="pre">386</span></code> array (384 integer pixel values at 12 bit  + 2 binary trigger input values).  The file name should be <code class="docutils literal"><span class="pre">[save_path]\[file_string]_DMS_raw_0000.dat</span></code>. Increment the integer until either <code class="docutils literal"><span class="pre">save_path</span></code> or <code class="docutils literal"><span class="pre">file_string</span></code> changes.  When complete, show the saved file name with full path in an informational popup. (See <a class="reference internal" href="firmware_spec.html#recording-raw-data"><span>Recording Raw Data</span></a>.)</li>
<li><strong>Monitor dispense.</strong> Run <code class="docutils literal"><span class="pre">monitor_dispense()</span></code>.  Save the resulting <a class="reference internal" href="firmware_spec.html#dispense-data"><span>Table 1.5</span></a> <a class="reference internal" href="firmware_spec.html#dispense-data"><span>Dispense Data</span></a> to <code class="docutils literal"><span class="pre">[save_path]\[file_string]_DMS_data_0000.dat</span></code> on the host in some sensible format that we can get into Matlab. Increment the integer index in the filename until either <code class="docutils literal"><span class="pre">save_path</span></code> or <code class="docutils literal"><span class="pre">file_string</span></code> changes. (See <a class="reference internal" href="firmware_spec.html#monitor-dispense"><span>Monitor Dispense</span></a>.)</li>
<li><strong>Set reference dispense.</strong> If there is at least one entry in <code class="docutils literal"><span class="pre">history</span></code>, run <code class="docutils literal"><span class="pre">set_reference_dispense()</span></code> . Otherwise, show a warning <code class="docutils literal"><span class="pre">'No</span> <span class="pre">reference</span> <span class="pre">dispense</span> <span class="pre">in</span> <span class="pre">memory.'</span></code> and exit.  If <code class="docutils literal"><span class="pre">ref-mode</span></code> is not <code class="docutils literal"><span class="pre">'user'</span></code>, prompt to set this value, with confirm and cancel buttons. (See <a class="reference internal" href="firmware_spec.html#fault-detection"><span>Fault Detection</span></a>.)</li>
<li><strong>Set reference mode.</strong> Provide a listbox for the user to select one of the valid values of <code class="docutils literal"><span class="pre">ref_mode</span></code> as defined in <a class="reference internal" href="firmware_spec.html#configuration-parameters"><span>Table 1.1</span></a> <a class="reference internal" href="firmware_spec.html#configuration-parameters"><span>Configuration Parameters</span></a>.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="biotek-application-interface">
<span id="biotek-interface"></span><h2>3.5. BioTek Application Interface<a class="headerlink" href="#biotek-application-interface" title="Permalink to this headline">¶</a></h2>
<p>In addition to being able to launch the GUI described above, the BioTek user interface should also be able to talk directly to the DMS to do the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Connect to a specific dispenser given a known <code class="docutils literal"><span class="pre">idstr</span></code>.</li>
<li>Set the <a class="reference internal" href="firmware_spec.html#configuration-parameters"><span>Configuration Parameters</span></a>.</li>
<li>Run <code class="docutils literal"><span class="pre">monitor_dispense()</span></code>.</li>
<li>Run <code class="docutils literal"><span class="pre">set_reference_dispense()</span></code>.</li>
<li>Retrieve fault data. (Implementation details TBD)</li>
</ol>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index_BioTek.html">
              <img class="logo" src="_static/Creare_DMS.png" alt="Logo"/>
            </a></p>
  <h3><a href="index_BioTek.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. Interface Specification</a><ul>
<li><a class="reference internal" href="#copyright">3.1. Copyright</a></li>
<li><a class="reference internal" href="#overview">3.2. Overview</a></li>
<li><a class="reference internal" href="#host">3.3. Host</a></li>
<li><a class="reference internal" href="#configuration-gui">3.4. Configuration GUI</a></li>
<li><a class="reference internal" href="#biotek-application-interface">3.5. BioTek Application Interface</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index_BioTek.html">Documentation overview</a><ul>
      <li>Previous: <a href="interface_control_doc.html" title="previous chapter">2. Interface Control Document</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/interface_spec.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Creare.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/interface_spec.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>